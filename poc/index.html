<!DOCTYPE html>
<html>
<head>
    <title>Grand Strategy POC</title>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="game" x-data="game">
        <!-- Game Board -->
        <div id="board">
            <template x-for="i in 49" :key="i">
                <div 
                    @click="clickProvince(i-1)"
                    class="province"
                    :class="{
                        'blue': getOwner(i-1) === 0,
                        'red': getOwner(i-1) === 1,
                        'green': getOwner(i-1) === 2,
                        'selected': hasSelectedArmy(i-1) || selectedProvince === (i-1),
                        'moveable': canMoveTo(i-1)
                    }"
                >
                    <div class="province-id" x-text="i-1"></div>
                    
                    <!-- Move button appears when armies are selected and can move there -->
                    <button 
                        x-show="selectedArmy !== null && canMoveTo(i-1)"
                        @click.stop="moveSelectedArmy(i-1)"
                        class="move-btn"
                    >
                        MOVE
                    </button>
                    
                    <!-- Build button appears on hover for player provinces -->
                    <button 
                        x-show="getOwner(i-1) === 0 && gold >= 50"
                        @click.stop="buildArmyAt(i-1)"
                        class="build-btn"
                    >
                        BUILD
                    </button>
                    
                    <div 
                        x-show="hasArmy(i-1)"
                        class="army"
                        :class="{
                            'blue': getArmyOwner(i-1) === 0,
                            'red': getArmyOwner(i-1) === 1,
                            'green': getArmyOwner(i-1) === 2,
                            [getMoraleClass(i-1)]: true
                        }"
                        x-text="getArmySize(i-1)"
                    ></div>
                    
                    <!-- Movement arrows -->
                    <div 
                        x-show="getMovementArrow(i-1)"
                        class="movement-arrow"
                        :class="getMovementArrow(i-1)"
                        x-text="getMovementProgress(i-1)"
                    ></div>
                    
                    <!-- Conquest indicator -->
                    <div 
                        x-show="isConquering(i-1)"
                        class="conquest-indicator"
                        x-text="getConquestProgress(i-1)"
                        style="background: red !important; font-size: 20px !important;"
                    >CONQ</div>
                </div>
            </template>
        </div>
        
        <!-- Sidebar -->
        <div id="sidebar">
            <h2>Grand Strategy</h2>
            
            <div class="stats">
                <div class="stat">Gold: <b x-text="gold"></b></div>
                <div class="stat">Income: <b x-text="income"></b>/tick</div>
                <div class="stat">Provinces: <b x-text="provinceCount"></b></div>
                <div class="stat">Tick: <b x-text="tick"></b></div>
            </div>
            
            <div x-show="gameOver" class="game-over">
                <h3>ðŸŽ‰ Game Over! ðŸŽ‰</h3>
                <p x-show="winner === 0">You Won!</p>
                <p x-show="winner === 1">Red Kingdom Wins!</p>
                <p x-show="winner === 2">Green Republic Wins!</p>
                <button @click="location.reload()">Play Again</button>
            </div>
            
            <!-- Build button moved to province hover -->
            
            <button @click="paused = !paused">
                <span x-text="paused ? 'Resume' : 'Pause'"></span>
            </button>
            
            <div class="speed-controls">
                <button @click="setSpeed(1000)">Speed: 1x</button>
                <button @click="setSpeed(500)">Speed: 2x</button>
                <button @click="setSpeed(333)">Speed: 3x</button>
            </div>
            
            <div class="info">
                <h3>How to Play</h3>
                <ul>
                    <li>Click your blue army to select all armies there</li>
                    <li>Click adjacent provinces to move selected armies</li>
                    <li>Armies take 3 ticks to move (arrows show direction)</li>
                    <li>Armies need 2 ticks to conquer territory (orange countdown)</li>
                    <li>Army morale affects combat strength (gold glow = high, red border = low)</li>
                    <li>Hover over blue provinces to see BUILD button</li>
                    <li>Build armies for 50 gold each</li>
                    <li>Capture 37 provinces to win!</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script src="game.js"></script>
</body>
</html>